{"version":3,"sources":["app.js"],"names":["paso","pasoInicial","pasoFinal","cita","id","nombre","fecha","hora","servicios","iniciarApp","mostrarSeccion","tabs","botonesPaginador","paginaSiguiente","paginaAnterior","consultarAPI","idCliente","nombreCliente","seleccionarFecha","seleccionarHora","mostrarResumenCita","seccionAnterior","document","querySelector","classList","remove","add","tabAnterior","querySelectorAll","forEach","boton","addEventListener","e","parseInt","target","dataset","async","url","resultado","fetch","mostrarServicios","json","error","console","log","servicio","precio","nombreServicio","createElement","textContent","precioServicio","servicioDiv","idServicio","onclick","seleccionarServicio","appendChild","divServicio","some","agregado","filter","value","dia","Date","getUTCDay","includes","mostrarAlerta","mensaje","tipo","elemento","ocultar","alertaPrevia","alerta","setTimeout","split","resumen","firstChild","removeChild","Object","values","length","headServicios","contenedorServicio","textoServicio","innerHTML","headCitas","FechaObj","mes","getMonth","getDate","año","getFullYear","FechaFormateada","UTC","toLocaleDateString","weekday","year","month","day","fechaCita","horaCita","botonReservar","reservarCita","datos","FormData","map","append","respuesta","method","body","Swal","fire","icon","title","text","button","then","window","location","reload"],"mappings":"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","file":"app.js","sourcesContent":["let paso = 1;\r\nconst pasoInicial = 1;\r\nconst pasoFinal = 3;\r\n\r\nconst cita = {\r\n    id: '',\r\n    nombre: '',\r\n    fecha: '',\r\n    hora: '',\r\n    servicios: []\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    iniciarApp();\r\n});\r\n\r\nfunction iniciarApp() {\r\n    mostrarSeccion(); //llamamos la 1ra sección con el \"paso = 1\"\r\n    tabs(); //Cambiar de sección\r\n    botonesPaginador();\r\n    paginaSiguiente();\r\n    paginaAnterior();\r\n\r\n    consultarAPI();\r\n\r\n    idCliente();\r\n    nombreCliente();\r\n    seleccionarFecha();\r\n    seleccionarHora();\r\n\r\n    mostrarResumenCita();\r\n}\r\n\r\nfunction mostrarSeccion() {\r\n    //Para ocultar una de las secciones anteriores\r\n    const seccionAnterior = document.querySelector('.mostrar');\r\n    if (seccionAnterior) {\r\n        seccionAnterior.classList.remove('mostrar');\r\n    }\r\n\r\n    //Mostrar una de las secciones\r\n    const seccion = document.querySelector( `#paso-${paso}` );\r\n    seccion.classList.add('mostrar');\r\n\r\n    //Despintar la Navegación anterior\r\n    const tabAnterior = document.querySelector('.actual');\r\n    if (tabAnterior) {\r\n        tabAnterior.classList.remove('actual');\r\n    }\r\n\r\n    //Pintar la Navegación segun la seccion\r\n    const tab = document.querySelector(`[data-paso='${paso}']`);\r\n    tab.classList.add('actual');\r\n}\r\n\r\nfunction tabs() {\r\n    const botones = document.querySelectorAll('.tabs button');\r\n    botones.forEach( boton => {\r\n        boton.addEventListener('click', (e) => {\r\n            paso = parseInt( e.target.dataset.paso );\r\n\r\n            mostrarSeccion();\r\n\r\n            botonesPaginador();\r\n        })\r\n    });\r\n}\r\n\r\nfunction botonesPaginador() {\r\n    const paginaSiguiente = document.querySelector('#siguiente');\r\n    const paginaAnterior = document.querySelector('#anterior');\r\n\r\n    if (paso === 1) {\r\n        paginaAnterior.classList.add('ocultar');\r\n        paginaSiguiente.classList.remove('ocultar');\r\n    } else if (paso === 3) {\r\n        paginaSiguiente.classList.add('ocultar');\r\n        paginaAnterior.classList.remove('ocultar');\r\n\r\n        mostrarResumenCita();\r\n    }else {\r\n        paginaAnterior.classList.remove('ocultar');\r\n        paginaSiguiente.classList.remove('ocultar');\r\n    }\r\n\r\n    mostrarSeccion();\r\n\r\n}\r\n\r\nfunction paginaAnterior() {\r\n    const paginaAnterior = document.querySelector('#anterior');\r\n    paginaAnterior.addEventListener('click', () => {\r\n        if (paso <= pasoInicial) return;\r\n        paso--;\r\n\r\n        botonesPaginador();\r\n    })\r\n}\r\n\r\nfunction paginaSiguiente() {\r\n    const paginaSiguiente = document.querySelector('#siguiente');\r\n    paginaSiguiente.addEventListener('click', () => {\r\n        if (paso >= pasoFinal) return;\r\n        paso++;\r\n\r\n        botonesPaginador();\r\n    })\r\n}\r\n\r\nasync function consultarAPI() {\r\n    try {\r\n        const url = 'http://localhost:3000/api/servicios';\r\n        const resultado = await fetch(url);\r\n        const servicios = await resultado.json();\r\n        mostrarServicios( servicios )\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n}\r\n\r\nfunction mostrarServicios( servicios ) {\r\n    servicios.forEach( servicio => {\r\n        const {id, nombre, precio} = servicio;\r\n\r\n        const nombreServicio = document.createElement('p');\r\n        nombreServicio.classList.add('nombre-servicio');\r\n        nombreServicio.textContent = nombre;\r\n\r\n        const precioServicio = document.createElement('p');\r\n        precioServicio.classList.add('precio-servicio');\r\n        precioServicio.textContent = precio;\r\n\r\n        const servicioDiv = document.createElement('div');\r\n        servicioDiv.classList.add('servicio');\r\n        servicioDiv.dataset.idServicio = id;\r\n        servicioDiv.onclick = function() {\r\n            seleccionarServicio(servicio)\r\n        }\r\n\r\n        servicioDiv.appendChild(nombreServicio);\r\n        servicioDiv.appendChild(precioServicio);\r\n\r\n        document.querySelector('#servicios').appendChild(servicioDiv);\r\n    });\r\n}\r\n\r\nfunction seleccionarServicio(servicio) {\r\n    const { id } = servicio;\r\n    const {servicios} = cita;\r\n    const divServicio = document.querySelector(`[data-id-servicio=\"${id}\"]`);\r\n\r\n    //comprobar si un servicio ya fue agregado\r\n    if (servicios.some( agregado => agregado.id === id )) {\r\n        //eliminar un servicio\r\n        cita.servicios = servicios.filter( agregado => agregado.id !== id );\r\n        divServicio.classList.remove('seleccionado');\r\n    } else {\r\n        //copio el arreglo y le agrego un nuevo servicio\r\n        cita.servicios = [...servicios, servicio];\r\n        divServicio.classList.add('seleccionado');\r\n    }\r\n}\r\n\r\nfunction idCliente() {\r\n    cita.id = document.querySelector('#id').value;    \r\n}\r\n\r\nfunction nombreCliente() {\r\n    const nombre = document.querySelector('#nombre').value;\r\n\r\n    cita.nombre = nombre;\r\n}\r\n\r\nfunction seleccionarFecha() {\r\n    const inputFecha = document.querySelector('#fecha');\r\n    inputFecha.addEventListener('input', (e) => { \r\n        const dia = new Date(e.target.value).getUTCDay();\r\n\r\n        if ([6, 0].includes(dia)) {\r\n            e.target.value = '';\r\n            mostrarAlerta('fines de semana no permitidos', 'error', '.formulario');\r\n        } else {\r\n            cita.fecha = e.target.value;\r\n        }\r\n    });\r\n}\r\n\r\nfunction mostrarAlerta(mensaje, tipo, elemento, ocultar = true) {\r\n\r\n    //Prevenir que se muestre más de una alerta\r\n    const alertaPrevia = document.querySelector('.alertas')\r\n    if (alertaPrevia) {\r\n        alertaPrevia.remove();\r\n    }\r\n\r\n    //Creando la alerta\r\n    const alerta = document.createElement('div');\r\n    alerta.textContent = mensaje;\r\n    alerta.classList.add('alertas');\r\n    alerta.classList.add(tipo);\r\n\r\n    const divFormulacio = document.querySelector(elemento);\r\n    divFormulacio.appendChild(alerta);\r\n\r\n    if (ocultar) {\r\n        //elimando la alerta\r\n        setTimeout(() => {\r\n            alerta.remove();\r\n        }, 3000);\r\n    }\r\n}\r\n\r\nfunction seleccionarHora() {\r\n    const inputHora = document.querySelector('#hora');\r\n    inputHora.addEventListener('input', (e) => { \r\n        const horaCita = e.target.value;\r\n        const hora = horaCita.split(\":\")[0];\r\n\r\n        if (hora < 10 || hora > 18 ) {\r\n            e.target.value = '';\r\n            mostrarAlerta('Hora no disponible', 'error', '.formulario')\r\n        } else {\r\n            cita.hora = e.target.value;\r\n        }\r\n    });\r\n}\r\n\r\nfunction mostrarResumenCita() {\r\n    const resumen = document.querySelector('.contenido-resumen');\r\n\r\n    //limpiar el contenido de resumen\r\n    while (resumen.firstChild) {\r\n        resumen.removeChild(resumen.firstChild);\r\n    }\r\n\r\n    if (Object.values(cita).includes('') || cita.servicios.length === 0) {\r\n        mostrarAlerta('Faltan Datos de Servicio, Fecha u Hora', 'error', '.contenido-resumen', false);\r\n        \r\n        return;\r\n    }\r\n\r\n    //Mostrando los elementos en Resumen\r\n    const {nombre, fecha, hora, servicios} = cita;\r\n    //Cabecera para los Servicios\r\n    const headServicios = document.createElement('H3')\r\n    headServicios.textContent = 'Resumen de los Servicios';\r\n    resumen.appendChild(headServicios);\r\n\r\n    servicios.forEach( servicio => {\r\n        const {id, nombre, precio} = servicio;\r\n\r\n        const contenedorServicio = document.createElement('DIV');\r\n        contenedorServicio.classList.add('contenedor-servicio');\r\n\r\n        const textoServicio = document.createElement('P');\r\n        textoServicio.textContent = nombre;\r\n\r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.innerHTML = `<span>Precio: </span> ${precio}`;\r\n\r\n        contenedorServicio.appendChild(textoServicio);\r\n        contenedorServicio.appendChild(precioServicio);\r\n\r\n        resumen.appendChild(contenedorServicio);\r\n    });\r\n\r\n    //Cabecera para las Citas\r\n    const headCitas = document.createElement('H3')\r\n    headCitas.textContent = 'Resumen de los Citas';\r\n    resumen.appendChild(headCitas);\r\n\r\n    const nombreCliente = document.createElement('P');\r\n    nombreCliente.innerHTML = `<span>Nombre: </span> ${nombre}`;\r\n\r\n    //Formatear Fecha a Español\r\n    const FechaObj = new Date(fecha);\r\n    const mes = FechaObj.getMonth();\r\n    const dia = FechaObj.getDate() + 2;\r\n    const año = FechaObj.getFullYear();\r\n\r\n    const FechaUTC = new Date( Date.UTC(año, mes, dia));\r\n\r\n    const opciones = {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'};\r\n    const FechaFormateada = FechaUTC.toLocaleDateString('es-ES', opciones)\r\n\r\n    const fechaCita = document.createElement('P');\r\n    fechaCita.innerHTML = `<span>Fecha: </span> ${FechaFormateada}`;\r\n\r\n    const horaCita = document.createElement('P');\r\n    horaCita.innerHTML = `<span>Hora: </span> ${hora}`;\r\n\r\n    //Boton para crear un cita\r\n    const botonReservar = document.createElement('button');\r\n    botonReservar.classList.add('btn');\r\n    botonReservar.textContent = 'Reservar Cita';\r\n    botonReservar.onclick = reservarCita;\r\n    \r\n    resumen.appendChild(nombreCliente);\r\n    resumen.appendChild(fechaCita);\r\n    resumen.appendChild(horaCita);\r\n    resumen.appendChild(botonReservar);\r\n}\r\n\r\nasync function reservarCita() {\r\n    const datos = new FormData();\r\n    const {id, nombre, fecha, hora, servicios} = cita;\r\n\r\n    const idServicio = servicios.map(servicio => servicio.id);\r\n\r\n    datos.append('usuarioId', id);\r\n    datos.append('fecha', fecha);\r\n    datos.append('hora', hora);\r\n    datos.append('servicios', idServicio);\r\n    \r\n    try {\r\n        //consultando API\r\n        const url = 'http://localhost:3000/api/citas';\r\n        const respuesta = await fetch(url, {\r\n            method: 'POST',\r\n            body: datos\r\n        });\r\n        const resultado = await respuesta.json();\r\n\r\n        if (resultado.resultado) {\r\n            Swal.fire({\r\n                icon: 'success',\r\n                title: 'Cita Creada',\r\n                text: 'Tu Cita fue Creada correctamente!',\r\n                button: 'Ok'\r\n            }).then( () => {\r\n                window.location.reload();\r\n            });\r\n        }\r\n    } catch (error) {\r\n        Swal.fire({\r\n            icon: 'error',\r\n            title: 'Error',\r\n            text: 'Hubo un error al guardar la cita',\r\n            button: 'Ok'\r\n          })\r\n    }\r\n    /* console.log([...datos]); Para ver los datos del FormData() */\r\n}"]}